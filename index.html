<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TwoBob Tactics - Tetris Multiplayer</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
    
</head>
<body>
    <div class="container">
        <!-- Menu Screen -->
        <div id="menu-screen" class="screen menu-screen">
            <h1 class="game-title">üéÆ TwoBob Tactics</h1>
            <div id="connection-status" class="connection-status disconnected">
                üî¥ ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
            </div>
            <div class="menu-buttons">
                <button id="btn-create-room" class="btn">üè† ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á</button>
                <button id="btn-join-room" class="btn">üö™ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏´‡πâ‡∏≠‡∏á</button>
            </div>
        </div>

        <!-- Connection Screen -->
        <div id="connection-screen" class="screen">
            <h2>‚ö†Ô∏è ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡∏≤‡∏î‡∏´‡∏≤‡∏¢</h2>
            <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà...</p>
        </div>

        <!-- Create Room Dialog -->
        <div id="create-room-screen" class="screen">
            <h2>üè† ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</h2>
            <div class="form-group">
                <input id="create-player-name" class="form-input" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô" maxlength="20">
            </div>
            <div class="menu-buttons">
                <button id="btn-confirm-create" class="btn">‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á</button>
                <button onclick="showScreen('menu-screen')" class="btn">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            </div>
        </div>

        <!-- Join Room Dialog -->
        <div id="join-room-screen" class="screen">
            <h2>üö™ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏´‡πâ‡∏≠‡∏á</h2>
            <div class="form-group">
                <input id="join-player-name" class="form-input" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô" maxlength="20">
            </div>
            <div class="form-group">
                <input id="join-room-id" class="form-input" type="text" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≠‡∏á" maxlength="10">
            </div>
            <div class="menu-buttons">
                <button id="btn-confirm-join" class="btn">‚úÖ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</button>
                <button onclick="showScreen('menu-screen')" class="btn">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            </div>
        </div>

        <!-- Waiting Screen -->
        <div id="waiting-screen" class="screen">
            <div class="room-info">
                <div class="room-id">
                    ‡∏´‡πâ‡∏≠‡∏á: <span id="room-id-display">-</span>
                    <button id="btn-copy-room" class="copy-btn" title="‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≠‡∏á">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                
                <h3>‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á:</h3>
                <ul id="players-list" class="players-list">
                </ul>
                
                <div id="ready-indicators">
                    <div id="ready-indicator-1">Player 1: ‡∏£‡∏≠...</div>
                    <div id="ready-indicator-2">Player 2: ‡∏£‡∏≠...</div>
                </div>

                <!-- Share Options -->
                <div class="share-section">
                    <div class="share-title">‡πÄ‡∏ä‡∏¥‡∏ç‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô</div>
                    <div class="share-buttons">
                        <button id="btn-share-link" class="share-btn">
                            <i class="fas fa-link"></i> ‡πÅ‡∏ä‡∏£‡πå‡∏•‡∏¥‡∏á‡∏Å‡πå
                        </button>
                        <button id="btn-share-qr" class="share-btn">
                            <i class="fas fa-qrcode"></i> QR Code
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="menu-buttons">
                <button id="btn-ready" class="btn" disabled>üéÆ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏•‡πà‡∏ô</button>
                <button id="btn-leave-room" class="btn">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏´‡πâ‡∏≠‡∏á</button>
            </div>
        </div>
        
        <!-- Game Screen -->
        <div id="game-screen" class="screen">
            <div class="game-container">
                <!-- Left Panel - Player Info & Next Piece -->
                <div class="left-panel">
                    <div class="player-info-card">
                        <div class="player-label">PLAYER</div>
                        <div id="my-player-name" class="player-name-display">YOU</div>
                        <div style="margin-top: 10px; font-size: 0.9rem;">LEVEL</div>
                        <div style="font-size: 1.5rem; font-weight: bold;" id="my-level">1</div>
                    </div>
                    
                    <div class="next-piece-container">
                        <div class="next-piece-title">NEXT PIECE</div>
                        <div id="next-piece-display" class="next-piece"></div>
                    </div>
                    
                    <div class="stats-card">
                        <div style="margin-bottom: 10px;">
                            <div style="color: #00ffff; font-weight: bold;">SCORE</div>
                            <div style="font-size: 1.2rem;" id="my-score">0</div>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <div style="color: #00ffff; font-weight: bold;">LINES</div>
                            <div id="my-lines">0</div>
                        </div>
                        <div>
                            <div style="color: #00ffff; font-weight: bold;">HIGH SCORE</div>
                            <div style="font-size: 1.1rem;">9999</div>
                        </div>
                    </div>
                </div>
                
                <!-- Center - Main Game Board -->
                <div class="main-player-area">
                    <div id="my-board" class="tetris-board main-board"></div>
                </div>
                
                <!-- Right Panel - Opponent -->
                <div class="right-panel">
                    <div class="opponent-info-card">
                        <div class="opponent-label">OPPONENT</div>
                        <div id="opponent-player-name" class="player-name-display">‡∏ù‡πà‡∏≤‡∏¢‡∏ï‡∏£‡∏á‡∏Ç‡πâ‡∏≤‡∏°</div>
                    </div>
                    
                    <div id="opponent-board" class="tetris-board opponent-board"></div>
                    
                    <div class="opponent-stats-card">
                        <div style="margin-bottom: 8px;">
                            <div style="color: #ff6b6b; font-weight: bold;">SCORE</div>
                            <div id="opponent-score">0</div>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <div style="color: #ff6b6b; font-weight: bold;">LINES</div>
                            <div id="opponent-lines">0</div>
                        </div>
                        <div>
                            <div style="color: #ff6b6b; font-weight: bold;">LEVEL</div>
                            <div id="opponent-level">1</div>
                        </div>
                    </div>
                </div>
            </div>
            
        <!-- Game Over Screen -->
        <div id="game-over-screen" class="screen">
            <div id="winner-message" class="winner-announcement">üéâ ‡∏Ñ‡∏∏‡∏ì‡∏ä‡∏ô‡∏∞!</div>
            <div class="final-scores">
                <h3>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢</h3>
                <div class="score-row">
                    <span id="final-name-p1">Player 1</span>:
                    <span id="final-score-p1">0</span>
                </div>
                <div class="score-row">
                    <span id="final-name-p2">Player 2</span>:
                    <span id="final-score-p2">0</span>
                </div>
            </div>
            <div class="menu-buttons">
                <button id="btn-play-again" class="btn">üîÑ ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
                <button onclick="window.location.reload()" class="btn">üè† ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π</button>
            </div>
        </div>
    </div>

    <div id="notificationContainer" class="notification-container"></div>

    <script src="client.js"></script>
    <script src="game-class.js"></script>
    <script>
        // Utility function to show screens
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.style.display = 'none';
            });
            document.getElementById(screenId).style.display = 'block';
        }

        // Copy room ID functionality
        function copyRoomId() {
            const roomId = document.getElementById('room-id-display').textContent;
            if (roomId && roomId !== '-') {
                navigator.clipboard.writeText(roomId).then(() => {
                    showNotification('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß!', 'success');
                });
            }
        }

        // Share link functionality
        function shareRoomLink() {
            const roomId = document.getElementById('room-id-display').textContent;
            if (roomId && roomId !== '-') {
                const shareUrl = `${window.location.origin}${window.location.pathname}?room=${roomId}`;
                const shareText = `‡∏°‡∏≤‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏ó‡∏ï‡∏£‡∏¥‡∏™‡∏Å‡∏±‡∏ô‡πÄ‡∏ñ‡∏≠‡∏∞! ‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≠‡∏á: ${roomId}\n${shareUrl}`;
                
                if (navigator.share) {
                    navigator.share({
                        title: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÄ‡∏Å‡∏° TwoBob Tactics',
                        text: shareText,
                        url: shareUrl
                    });
                } else {
                    navigator.clipboard.writeText(shareUrl).then(() => {
                        showNotification('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡πâ‡∏ß!', 'success');
                    });
                }
            }
        }

        // QR Code functionality
        function showQRCode() {
            const roomId = document.getElementById('room-id-display').textContent;
            if (roomId && roomId !== '-') {
                const shareUrl = `${window.location.origin}${window.location.pathname}?room=${roomId}`;
                const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(shareUrl)}`;
                
                // Create modal for QR code
                const modal = document.createElement('div');
                modal.className = 'qr-modal';
                modal.innerHTML = `
                    <div class="qr-content">
                        <h3>üì± ‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏´‡πâ‡∏≠‡∏á</h3>
                        <img src="${qrUrl}" alt="QR Code" style="max-width: 200px;">
                        <p>‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≠‡∏á: <strong>${roomId}</strong></p>
                        <button onclick="this.parentElement.parentElement.remove()" class="btn" style="margin-top: 15px;">‡∏õ‡∏¥‡∏î</button>
                    </div>
                `;
                
                // Close modal when clicking outside
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });
                
                document.body.appendChild(modal);
            }
        }

        // Notification function
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            const container = document.getElementById('notificationContainer');
            if (container) {
                container.appendChild(notification);
            } else {
                document.body.appendChild(notification);
            }
            
            setTimeout(() => notification.remove(), 3000);
        }

        // Initialize game when page loads
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof TetrisMultiplayer !== 'undefined') {
                window.tetrisGame = new TetrisMultiplayer();
            }

            // Event listeners for share features
            document.getElementById('btn-copy-room')?.addEventListener('click', copyRoomId);
            document.getElementById('btn-share-link')?.addEventListener('click', shareRoomLink);
            document.getElementById('btn-share-qr')?.addEventListener('click', showQRCode);
            
            // Check for room parameter in URL for auto-join
            const urlParams = new URLSearchParams(window.location.search);
            const roomParam = urlParams.get('room');
            if (roomParam) {
                document.getElementById('join-room-id').value = roomParam;
                showScreen('join-room-screen');
                showNotification('‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô', 'info');
            }
        });
    </script>
</body>
</html>




