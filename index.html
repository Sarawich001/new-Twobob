<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TwoBob Tactics - Tetris Multiplayer</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>

</head>
<body>
    <div class="container">
        <!-- Menu Screen -->
        <div id="menu-screen" class="screen menu-screen">
            <h1 class="game-title">ğŸ® TwoBob Tactics</h1>
            <div id="connection-status" class="connection-status disconnected">
                ğŸ”´ à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­
            </div>
            <div class="menu-buttons">
                <button id="btn-create-room" class="btn">ğŸ  à¸ªà¸£à¹‰à¸²à¸‡à¸«à¹‰à¸­à¸‡</button>
                <button id="btn-join-room" class="btn">ğŸšª à¹€à¸‚à¹‰à¸²à¸£à¹ˆà¸§à¸¡à¸«à¹‰à¸­à¸‡</button>
            </div>
        </div>

        <!-- Connection Screen -->
        <div id="connection-screen" class="screen">
            <h2>âš ï¸ à¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸‚à¸²à¸”à¸«à¸²à¸¢</h2>
            <p>à¸à¸³à¸¥à¸±à¸‡à¸à¸¢à¸²à¸¢à¸²à¸¡à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¹ƒà¸«à¸¡à¹ˆ...</p>
        </div>

        <!-- Create Room Dialog -->
        <div id="create-room-screen" class="screen">
            <h2>ğŸ  à¸ªà¸£à¹‰à¸²à¸‡à¸«à¹‰à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆ</h2>
            <div class="form-group">
                <input id="create-player-name" class="form-input" type="text" placeholder="à¸Šà¸·à¹ˆà¸­à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™" maxlength="20">
            </div>
            <div class="menu-buttons">
                <button id="btn-confirm-create" class="btn">âœ… à¸ªà¸£à¹‰à¸²à¸‡à¸«à¹‰à¸­à¸‡</button>
                <button onclick="showScreen('menu-screen')" class="btn">âŒ à¸¢à¸à¹€à¸¥à¸´à¸</button>
            </div>
        </div>

        <!-- Join Room Dialog -->
        <div id="join-room-screen" class="screen">
            <h2>ğŸšª à¹€à¸‚à¹‰à¸²à¸£à¹ˆà¸§à¸¡à¸«à¹‰à¸­à¸‡</h2>
            <div class="form-group">
                <input id="join-player-name" class="form-input" type="text" placeholder="à¸Šà¸·à¹ˆà¸­à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™" maxlength="20">
            </div>
            <div class="form-group">
                <input id="join-room-id" class="form-input" type="text" placeholder="à¸£à¸«à¸±à¸ªà¸«à¹‰à¸­à¸‡" maxlength="10">
            </div>
            <div class="menu-buttons">
                <button id="btn-confirm-join" class="btn">âœ… à¹€à¸‚à¹‰à¸²à¸£à¹ˆà¸§à¸¡</button>
                <button onclick="showScreen('menu-screen')" class="btn">âŒ à¸¢à¸à¹€à¸¥à¸´à¸</button>
            </div>
        </div>

        <!-- Waiting Screen -->
        <div id="waiting-screen" class="screen">
            <div class="room-info">
                <div class="room-id">
                    à¸«à¹‰à¸­à¸‡: <span id="room-id-display">-</span>
                    <button id="btn-copy-room" class="copy-btn" title="à¸„à¸±à¸”à¸¥à¸­à¸à¸£à¸«à¸±à¸ªà¸«à¹‰à¸­à¸‡">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                
                <h3>à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™à¹ƒà¸™à¸«à¹‰à¸­à¸‡:</h3>
                <ul id="players-list" class="players-list">
                </ul>
                
                <div id="ready-indicators">
                    <div id="ready-indicator-1">Player 1: à¸£à¸­...</div>
                    <div id="ready-indicator-2">Player 2: à¸£à¸­...</div>
                </div>

                <!-- Share Options -->
                <div class="share-section">
                    <div class="share-title">à¹€à¸Šà¸´à¸à¹€à¸à¸·à¹ˆà¸­à¸™</div>
                    <div class="share-buttons">
                        <button id="btn-share-link" class="share-btn">
                            <i class="fas fa-link"></i> à¹à¸Šà¸£à¹Œà¸¥à¸´à¸‡à¸à¹Œ
                        </button>
                        <button id="btn-share-qr" class="share-btn">
                            <i class="fas fa-qrcode"></i> QR Code
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="menu-buttons">
                <button id="btn-ready" class="btn" disabled>ğŸ® à¸à¸£à¹‰à¸­à¸¡à¹€à¸¥à¹ˆà¸™</button>
                <button id="btn-leave-room" class="btn">ğŸšª à¸­à¸­à¸à¸ˆà¸²à¸à¸«à¹‰à¸­à¸‡</button>
            </div>
        </div>
        
        <!-- à¹€à¸à¸¡ Screen -->
        <div id="game-screen" class="screen">
            <div class="game-container">
                <!-- Left Panel - Player Info & Next Piece -->
                <div class="left-panel">
                    <div class="player-info-card">
                        <div class="player-label">PLAYER</div>
                        <div id="my-player-name" class="player-name-display">YOU</div>
                        <div style="margin-top: 10px; font-size: 0.9rem;">LEVEL</div>
                        <div style="font-size: 1.5rem; font-weight: bold;" id="my-level">1</div>
                    </div>
                    
                    <div class="next-piece-container">
                        <div class="next-piece-title">NEXT PIECE</div>
                        <div id="next-piece-display" class="next-piece"></div>
                    </div>
                    
                    <div class="stats-card">
                        <div style="margin-bottom: 10px;">
                            <div style="color: #00ffff; font-weight: bold;">SCORE</div>
                            <div style="font-size: 1.2rem;" id="my-score">0</div>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <div style="color: #00ffff; font-weight: bold;">LINES</div>
                            <div id="my-lines">0</div>
                        </div>
                        <div>
                            <div style="color: #00ffff; font-weight: bold;">HIGH SCORE</div>
                            <div style="font-size: 1.1rem;">9999</div>
                        </div>
                    </div>
                </div>
                
                <!-- Center - Main Game Board -->
                <div class="main-player-area">
                    <div id="my-board" class="tetris-board main-board"></div>
                </div>
                
                <!-- Right Panel - Opponent -->
                <div class="right-panel">
                    <div class="opponent-info-card">
                        <div class="opponent-label">OPPONENT</div>
                        <div id="opponent-player-name" class="player-name-display">à¸à¹ˆà¸²à¸¢à¸•à¸£à¸‡à¸‚à¹‰à¸²à¸¡</div>
                    </div>
                    
                    <div id="opponent-board" class="tetris-board opponent-board"></div>
                    
                    <div class="opponent-stats-card">
                        <div style="margin-bottom: 8px;">
                            <div style="color: #ff6b6b; font-weight: bold;">SCORE</div>
                            <div id="opponent-score">0</div>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <div style="color: #ff6b6b; font-weight: bold;">LINES</div>
                            <div id="opponent-lines">0</div>
                        </div>
                        <div>
                            <div style="color: #ff6b6b; font-weight: bold;">LEVEL</div>
                            <div id="opponent-level">1</div>
                        </div>
                    </div>
                </div>
            </div>

        Â  Â  Â  Â  Â  Â  <!-- Mobile Controls -->

Â  Â  Â  Â  Â  Â  <div class="mobile-controls">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="control-grid">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="control-button" id="btn-left">â†</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="control-button" id="btn-right">â†’</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="control-button" id="btn-rotate">â†»</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="control-button" id="btn-drop">ğŸ’§</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="control-instructions">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Swipe: â†â†’ à¹€à¸¥à¸·à¹ˆà¸­à¸™, â†‘ à¸«à¸¡à¸¸à¸™, â†“ à¸”à¸£à¸­à¸›
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>    
        <!-- Game Over Screen -->
        <div id="game-over-screen" class="screen">
            <div id="winner-message" class="winner-announcement">ğŸ‰ à¸„à¸¸à¸“à¸Šà¸™à¸°!</div>
            <div class="final-scores">
                <h3>à¸„à¸°à¹à¸™à¸™à¸ªà¸¸à¸”à¸—à¹‰à¸²à¸¢</h3>
                <div class="score-row">
                    <span id="final-name-p1">Player 1</span>:
                    <span id="final-score-p1">0</span>
                </div>
                <div class="score-row">
                    <span id="final-name-p2">Player 2</span>:
                    <span id="final-score-p2">0</span>
                </div>
            </div>
            <div class="menu-buttons">
                <button id="btn-play-again" class="btn">ğŸ”„ à¹€à¸¥à¹ˆà¸™à¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡</button>
                <button onclick="window.location.reload()" class="btn">ğŸ  à¸à¸¥à¸±à¸šà¹€à¸¡à¸™à¸¹</button>
            </div>
        </div>
    </div>

    <div id="notificationContainer" class="notification-container"></div>

    <script src="client.js"></script>
    <script src="game-class.js"></script>
    <script src="Begin.js"></script>
    <script>
        // Utility function to show screens
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.style.display = 'none';
            });
            document.getElementById(screenId).style.display = 'block';
        }

        // Copy room ID functionality
        function copyRoomId() {
            const roomId = document.getElementById('room-id-display').textContent;
            if (roomId && roomId !== '-') {
                navigator.clipboard.writeText(roomId).then(() => {
                    showNotification('à¸„à¸±à¸”à¸¥à¸­à¸à¸£à¸«à¸±à¸ªà¸«à¹‰à¸­à¸‡à¹à¸¥à¹‰à¸§!', 'success');
                });
            }
        }

        // Share link functionality
        function shareRoomLink() {
            const roomId = document.getElementById('room-id-display').textContent;
            if (roomId && roomId !== '-') {
                const shareUrl = `${window.location.origin}${window.location.pathname}?room=${roomId}`;
                const shareText = `à¸¡à¸²à¹€à¸¥à¹ˆà¸™à¹€à¸—à¸•à¸£à¸´à¸ªà¸à¸±à¸™à¹€à¸–à¸­à¸°! à¸£à¸«à¸±à¸ªà¸«à¹‰à¸­à¸‡: ${roomId}\n${shareUrl}`;
                
                if (navigator.share) {
                    navigator.share({
                        title: 'à¹€à¸‚à¹‰à¸²à¸£à¹ˆà¸§à¸¡à¹€à¸à¸¡ TwoBob Tactics',
                        text: shareText,
                        url: shareUrl
                    });
                } else {
                    navigator.clipboard.writeText(shareUrl).then(() => {
                        showNotification('à¸„à¸±à¸”à¸¥à¸­à¸à¸¥à¸´à¸‡à¸à¹Œà¹à¸¥à¹‰à¸§!', 'success');
                    });
                }
            }
        }

        // QR Code functionality
        function showQRCode() {
            const roomId = document.getElementById('room-id-display').textContent;
            if (roomId && roomId !== '-') {
                const shareUrl = `${window.location.origin}${window.location.pathname}?room=${roomId}`;
                const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(shareUrl)}`;
                
                // Create modal for QR code
                const modal = document.createElement('div');
                modal.className = 'qr-modal';
                modal.innerHTML = `
                    <div class="qr-content">
                        <h3>ğŸ“± à¸ªà¹à¸à¸™ QR Code à¹€à¸à¸·à¹ˆà¸­à¹€à¸‚à¹‰à¸²à¸£à¹ˆà¸§à¸¡à¸«à¹‰à¸­à¸‡</h3>
                        <img src="${qrUrl}" alt="QR Code" style="max-width: 200px;">
                        <p>à¸£à¸«à¸±à¸ªà¸«à¹‰à¸­à¸‡: <strong>${roomId}</strong></p>
                        <button onclick="this.parentElement.parentElement.remove()" class="btn" style="margin-top: 15px;">à¸›à¸´à¸”</button>
                    </div>
                `;
                
                // Close modal when clicking outside
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });
                
                document.body.appendChild(modal);
            }
        }

        // Notification function
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            const container = document.getElementById('notificationContainer');
            if (container) {
                container.appendChild(notification);
            } else {
                document.body.appendChild(notification);
            }
            
            setTimeout(() => notification.remove(), 3000);
        }

        // Initialize game when page loads
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof TetrisMultiplayer !== 'undefined') {
                window.tetrisGame = new TetrisMultiplayer();
            }

            // Event listeners for share features
            document.getElementById('btn-copy-room')?.addEventListener('click', copyRoomId);
            document.getElementById('btn-share-link')?.addEventListener('click', shareRoomLink);
            document.getElementById('btn-share-qr')?.addEventListener('click', showQRCode);
            
            // Check for room parameter in URL for auto-join
            const urlParams = new URLSearchParams(window.location.search);
            const roomParam = urlParams.get('room');
            if (roomParam) {
                document.getElementById('join-room-id').value = roomParam;
                showScreen('join-room-screen');
                showNotification('à¸à¸šà¸£à¸«à¸±à¸ªà¸«à¹‰à¸­à¸‡à¹ƒà¸™à¸¥à¸´à¸‡à¸à¹Œ à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸à¸Šà¸·à¹ˆà¸­à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™', 'info');
            }
        });
    </script>
</body>
</html>









